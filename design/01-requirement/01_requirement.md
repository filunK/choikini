<!-- TOC -->

- [1. はじめに](#1-はじめに)
- [2. システム名とコンセプト](#2-システム名とコンセプト)
    - [2.1. システム名](#21-システム名)
    - [2.2. システム的側面からのコンセプト](#22-システム的側面からのコンセプト)
    - [2.3. 技術的側面からのコンセプト](#23-技術的側面からのコンセプト)
        - [2.3.1. スキルゼロベースからの開発](#231-スキルゼロベースからの開発)
        - [2.3.2. UMLを活用した設計](#232-umlを活用した設計)
- [3. 全体像と開発範囲](#3-全体像と開発範囲)
    - [3.1. コンポネント構成](#31-コンポネント構成)
    - [3.2. 開発スコープ](#32-開発スコープ)
    - [3.3. 使用技術](#33-使用技術)
        - [3.3.1. 言語](#331-言語)
        - [3.3.2. 基盤技術](#332-基盤技術)
        - [3.3.3. 主データストア](#333-主データストア)
        - [3.3.4. フレームワーク・ライブラリ](#334-フレームワーク・ライブラリ)
- [4. ユースケース(機能要件)](#4-ユースケース機能要件)
    - [4.1. ユースケース１：ログインを受け付ける](#41-ユースケース１ログインを受け付ける)
        - [4.1.1. ユースケース記述１：ログイン成功](#411-ユースケース記述１ログイン成功)
        - [4.1.2. ユースケース記述２：ログイン失敗](#412-ユースケース記述２ログイン失敗)
    - [4.2. ユースケース２：ちょい気にを登録する。](#42-ユースケース２ちょい気にを登録する)
        - [4.2.1. ユースケース記述１：和文登録成功](#421-ユースケース記述１和文登録成功)
        - [4.2.2. ユースケース記述2：欧文登録成功](#422-ユースケース記述2欧文登録成功)
        - [4.2.3. ユースケース記述3：登録失敗](#423-ユースケース記述3登録失敗)
    - [4.3. ユースケース3：登録したちょい気にを取得する](#43-ユースケース3登録したちょい気にを取得する)
        - [4.3.1. ユースケース記述1：一覧取得](#431-ユースケース記述1一覧取得)
    - [4.4. ユースケース４：全ユーザが登録したちょい気にを取得する](#44-ユースケース４全ユーザが登録したちょい気にを取得する)
        - [4.4.1. ユースケース記述1：全取得](#441-ユースケース記述1全取得)
- [5. 非機能要件](#5-非機能要件)

<!-- /TOC -->

# 1. はじめに

本ドキュメントは2017年度年間目標に設定した「アプリ開発」において設計・実装するシステムの要件を記述したものである。

# 2. システム名とコンセプト

## 2.1. システム名

本システムの名称は **choikini** (ちょい気に)とし、以降本システムを「choikini」と記載する。

## 2.2. システム的側面からのコンセプト

本システムは **三行提報** [^1]の仕組みをインスパイヤして作成するシステムである。  
グループや会社でのメンバーが「長々と書くことではないけれどもちょっと気になること」＝「ちょい気に」なことを投稿する。  
投稿を蓄積することで個々で見れば見つけられない問題点やビジネスチャンスを集合知として形成し、定量的・定性的な分析を可能とする。  

[^1][サトーグループ>グループ方針>全員参画の経営-三行提報](http://www.sato.co.jp/company/management/sangyo-teiho.html)

## 2.3. 技術的側面からのコンセプト

本システムを設計・実装するにあたり、以下のコンセプトを設定した。

### 2.3.1. スキルゼロベースからの開発

技術力向上を目的とし、開発者のスキルセットにない技術のみを使用して開発を行う。  
つまり、開発者が持っている以下のスキルは使用しない。

- .NET(C#)
- Java
- Android(Java)
- Bash(shellscript)
- SQL(Oracle)

上記以外の技術・言語を用いてchoikiniの設計・開発を行う。

### 2.3.2. UMLを活用した設計

現在の業務においてはExcel設計書で設計を記述していることがもっぱらである。  
choikiniの開発にあたって、UMLを主体とした設計を行うことによって、UML設計のモデルケースを作成する。

# 3. 全体像と開発範囲

## 3.1. コンポネント構成

choikiniのシステム全体の構成を以下に示す。

![コンポネント図](../out/01-requirement/01-02_CP_component/01-02-CP_コンポネント図.svg)

|コンポネント名    | 説明 |
|--------------:|:-----|
| WebInterface  | Webアプリ。ブラウザを経由してアクセスするもの。|
| NativeApps | RESTfull Web APIを利用するネイティブアプリ。<br />デスクトップアプリ、Androidアプリ、iOSアプリなど。 |
| APServer | システム本体。ロジック及びRESTfull Web APIを提供する。 |
| AnalyzeAP | APServerにて収集した情報を分析するためのシステム。<br />APServerと同様、RESTfull Web APIを提供する。 |{}
| Database | ユーザ情報やAPServerで処理した結果を永続化する主データストア |

## 3.2. 開発スコープ

今回の開発において、以下のコンポネントに対する開発を行う。

- APServer
- DataBase

RESTfull Web API 及び主データストアの設計・実装を開発範疇とする。

## 3.3. 使用技術

choikiniの開発において、以下の言語・技術を使用する。
いずれも「技術的側面からのコンセプト - スキルゼロベースからの開発」に合致するものである。

### 3.3.1. 言語

 *Typescript* を使用する。採用理由は以下のとおりである。

- AltJS[^2]であるため。 最終的にJavascirptへトランスパイルが可能であり、技術を身に付ければWEBアプリからデスクトップアプリまで応用範囲が広い。
- Javascript(ECMAScript 5)と比較するとクラス・インターフェースの概念があるなど、開発者がすでに持っているスキルの概念に近いものを持っているため。
- Javascriptにはない厳密な静的型付けがあるため、業務における大規模開発にも耐えられ、将来的に業務で使用しうると考えられるため採用した。

[^2]Alternative for Javascript。Javascriptの代替となるもの。

### 3.3.2. 基盤技術

 *Node* を使用する。採用理由は以下のとおりである。

- サーバーサイドJavascript実行環境としてデファクトスタンダード。
- MeteorなどのNodeをラッピングした、使い勝手を向上させた基盤が存在するが、技術力向上のため生の基盤を使用したいため。

### 3.3.3. 主データストア

 *MongoDB* を使用する。採用理由は以下のとおりである。

- NoSQLとして最も採用実績があるデータストア。
- ドキュメント指向データベースであり、かつ、インターフェースとしてはJSONを使用するため、開発言語として採用したTypescriot(Javascript)との親和性が高い。

### 3.3.4. フレームワーク・ライブラリ

choikiniで使用するフレームワーク・ライブラリは以下のとおりである。

|フレームワーク<br />ライブラリ名    | 説明 |
|--------------:|:-----|
| Express | Node上で動作するMVCフレームワーク |
| body-parser | Expressフレームワークで使用するリクエストパーサ |
| Log4js | ロガーライブラリ |
| config | 設定ファイル解決ライブラリ |
| mongoose | MongoDBへの接続ライブラリ |

# 4. ユースケース(機能要件)

choikiniのAPServerに関するユースケースを以下に示す。

![ユースケース図](../out/01-requirement/01-01_UC_choikini/01-01-UC_WEBAPIサーバのユースケース.svg)

| アクター名   | 説明 | ユースケース記述上のユーザ |
|-----------:|:-----|:-----------------:|
| FrontendWithNormalAuth | 一般ユーザ | kadokawa |
| FrontendWithHigherAuth | 高権限ユーザ | hayakawa |

## 4.1. ユースケース１：ログインを受け付ける

choikiniにログインするユースケース。

### 4.1.1. ユースケース記述１：ログイン成功

ユーザkadokawaはパスワードP@ssw0rdを使用してログインAPIを実行。
WebAPI側で正常に処理されて、JSONにてセッショントークンを受け取った。

### 4.1.2. ユースケース記述２：ログイン失敗

ユーザkadokawaはパスワードPasswordを使用してログインAPIを実行。
WebAPI側でログイン失敗となり、エラーのJSONを受け取った。

## 4.2. ユースケース２：ちょい気にを登録する。

ログインした後にちょい気にを入力する。  
システム全体としては文字列長の制限を160字とするが、フロントエンドでの制御を行い、Web API側での制御は行わない。

### 4.2.1. ユースケース記述１：和文登録成功

ユーザkadokawaは以下の文言を登録するため登録APIを実行。

> ちょい気にの投稿可能文字列が160文字だけしかないのは短すぎやしないか。  
> こんなに短い文字数では書きたいことも書けないのではないか。  
> そもそもちょっと気になることを登録することに意義を感じない。この情報からどうやって問題を見出すというのか。  
> 私には目的が見えなくて分からない。  
> 160文字というのは案外かけるものだな。

(160文字)  
WebAPI側で正常に処理された旨をJSONで受け取った。

### 4.2.2. ユースケース記述2：欧文登録成功

ユーザkadokawaは以下の文言を登録するためAPIを実行。

> Is it too short to have only 160 letters?  
> In such a short number of letters, I can not write what I have felt.  
> I do not feel the meaning to register an anxious.

(160文字)  
WebAPI側で正常に処理された旨をJSONで受け取った。

### 4.2.3. ユースケース記述3：登録失敗

ユーザkadokawaは以下の文言を登録するためAPIを実行。

> ちょい気にの投稿可能文字列が160文字だけしかないのは短すぎやしないか。  
> こんなに短い文字数では書きたいことも書けないのではないか。  
> そもそもちょっと気になることを登録することに意義を感じない。この情報からどうやって問題を見出すというのか。  
> 私には目的が見えなくて分からないよ。  
> 160文字というのは案外かけるものだな。  

(161文字)  
文字数超過の旨を受け取った。

## 4.3. ユースケース3：登録したちょい気にを取得する

ログインしたユーザに紐づくちょい気にの一覧を取得する。

### 4.3.1. ユースケース記述1：一覧取得

ユーザkadokawaは自分の登録したちょい気にを一覧取得した。

> ちょい気にの投稿可能文字列が160文字だけしかないのは短すぎやしないか。  
> こんなに短い文字数では書きたいことも書けないのではないか。  
> そもそもちょっと気になることを登録することに意義を感じない。この情報からどうやって問題を見出すというのか。  
> 私には目的が見えなくて分からない。  
> 160文字というのは案外かけるものだな。

> Is it too short to have only 160 letters?  
> In such a short number of letters, I can not write what I have felt.  
> I do not feel the meaning to register an anxious.

の内容が記載されたJSONを受け取った。

## 4.4. ユースケース４：全ユーザが登録したちょい気にを取得する

### 4.4.1. ユースケース記述1：全取得

ユーザhayakawaは全ユーザのちょい気にを一覧取得した。

- ユーザkadokawaの２件
- ユーザhayakawaの100件

のちょい気にが記載されたJSONを受けとった。

# 5. 非機能要件

非機能要件については設計・実装の範囲外とする。